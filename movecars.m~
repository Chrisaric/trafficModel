% movemcars.m
for b = 1:nb
    c = firstcar(b);
    while (c > 0)
        if (c == firstcar(b))
            if (bd(c) == b) && (pd(c) > p(c)
                d = dmax;
            elseif s(b) == 0)
                d = L(b) - p(c)
            else
                decidenextblock
                if (lastcar(nextb(c)) > 0
                    d = (L(b) - p(c)) + p(lastcar(nextb(c));
                else
                    d = dmax;
                end
            end
        else
            d = p(ca) - p(c);
        end
    pz = p(c);
    nextc = nextcar(c);
    p(c) = p(c) + dt
    
            